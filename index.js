(function(){"use strict";var a={inheritAttrs:!1,props:{search:Boolean},data:function(){return{query:null}},methods:{onInput:function(){}}};var b=function(a,b,c,d,e){const f=("function"==typeof c?c.options:c)||{};return f.__file="Searchbox.vue",f.render||(f.render=a.render,f.staticRenderFns=a.staticRenderFns,f._compiled=!0,e&&(f.functional=!0)),f._scopeId=d,f}({render:function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("div",{staticClass:"relationship-search"},[c("k-input",{attrs:{theme:"field",type:"text",spellcheck:"false",icon:"search"},on:{input:function(){a.onInput()}},model:{value:a.query,callback:function(b){a.query=b},expression:"query"}})],1)},staticRenderFns:[]},void 0,a,void 0,!1,void 0,void 0,void 0),c={inheritAttrs:!1,props:{items:Array,selected:{type:Array,default:function(){return[]}},sortable:Boolean,multiselectable:Boolean,deletable:Boolean,activedescendant:String},data:function(){return{items:this.items,selected:this.selected}},methods:{setupFocus:function(){this.focusFirstItem()},focusItem:function(a){console.log(a.text),this.activedescendant=this._uid+a.value},focusFirstItem:function(){var a=this.items[0];a&&this.focusItem(a)},onInput:function(a){this.$emit("input",a)},index:function(a){return this.state.findIndex(function(b){return b.value===a.value})},isSelected:function(a){for(var b=0;b<this.selected.length;b++)if(this.selected[b].value===a.value)return!0;return!1},selectItem:function(a){this.selected.push(a),this.onInput(this.items)},unselectItem:function(a){for(var b=0;b<this.selected.length;b++)if(this.selected[b].value===a.value)return this.selected.splice(b,1),void this.onInput(this.items)},removeItem:function(a){if(!this.deletable)return!1;var b=this.items.indexOf(a);-1!==b&&this.items.splice(b,1),this.onInput(this.items)},toggleItem:function(a){if(this.isSelected(a)?this.unselectItem(a):this.selectItem(a),this.multiselectable);}}};var d=function(a,b,c,d,e){const f=("function"==typeof c?c.options:c)||{};return f.__file="Listbox.vue",f.render||(f.render=a.render,f.staticRenderFns=a.staticRenderFns,f._compiled=!0,e&&(f.functional=!0)),f._scopeId=d,f}({render:function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("k-draggable",{attrs:{element:"ul",list:a.items,options:{disabled:!a.sortable,handle:".relationship-item-sort",animation:150,forceFallback:!0},"data-sortable":a.sortable,"data-multiselectable":a.multiselectable,"data-deletable":a.deletable,"aria-readonly":"","aria-activedescendant":a.activedescendant,"aria-label":"",role:"listbox",tabindex:"0"},on:{change:a.onInput},nativeOn:{focus:function(b){return a.setupFocus(b)}}},a._l(a.items,function(b){return c("li",{attrs:{id:a._uid+b.value,"aria-selected":a.isSelected(b),role:"option"},on:{click:function(){a.toggleItem(b)}}},[a.sortable?c("k-icon",{staticClass:"relationship-item-sort",attrs:{type:"sort"}}):a._e(),a._v(" "),c("span",{staticClass:"relationship-item-label"},[a._v(a._s(b.text))]),a._v(" "),a.multiselectable?c("k-button",{attrs:{tabindex:"-1",icon:"add"}}):a._e(),a._v(" "),a.deletable?c("k-button",{attrs:{tabindex:"-1",icon:"remove"},on:{click:function(){a.removeItem(b)}}}):a._e()],1)}))},staticRenderFns:[]},void 0,c,void 0,!1,void 0,void 0,void 0),e={inheritAttrs:!1,components:{"relationship-searchbox":b,"relationship-listbox":d},props:{autofocus:Boolean,disabled:Boolean,help:String,id:{type:[Number,String],default:function(){return this._uid}},label:String,name:String,options:{type:Array,default:function(){return[]}},required:Boolean,search:Boolean,value:{type:Array,default:function(){return[]}},multiselectable:String},data:function(){return{selected:this.value,query:null}},watch:{value:function(a){this.selected=a}},mounted:function(){console.log(this.value)},methods:{onInput:function(){this.$emit("input",this.selected)}},validations:function(){return{}}};var f=function(a,b,c,d,e){const f=("function"==typeof c?c.options:c)||{};return f.__file="Relationship.vue",f.render||(f.render=a.render,f.staticRenderFns=a.staticRenderFns,f._compiled=!0,e&&(f.functional=!0)),f._scopeId=d,f}({render:function(){var a=this,b=a.$createElement,c=a._self._c||b;return c("k-field",a._b({staticClass:"kirby-relationship-field"},"k-field",a.$props,!1),[a.search?c("relationship-searchbox"):a._e(),a._v(" "),c("div",{staticClass:"relationship-lists"},[c("relationship-listbox",{staticClass:"relationship-list",attrs:{items:a.options,selected:a.selected,multiselectable:!0,sortable:!1,deletable:!1},on:{input:a.onInput}}),a._v(" "),c("relationship-listbox",{staticClass:"relationship-list",attrs:{items:a.selected,multiselectable:!1,sortable:!0,deletable:!0},on:{input:a.onInput}})],1)],1)},staticRenderFns:[]},void 0,e,void 0,!1,void 0,void 0,void 0);panel.plugin("olach/relationship",{fields:{relationship:f}})})();
